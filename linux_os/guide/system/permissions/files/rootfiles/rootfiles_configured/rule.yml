documentation_complete: true

title: "Ensure rootfiles tmpfile.d is configured correctly"

description: |-
    To set the mode of the root user initialization file <tt>/root/.bash_profile</tt>,
    ensure the following line is is included in a file ending in <tt>.conf</tt> under
    <tt>/etc/tmpfiles.d/</tt>.
    <pre>
        C /root/.bash_logout   600 root root - /usr/share/rootfiles/.bash_logout
        C /root/.bash_profile  600 root root - /usr/share/rootfiles/.bash_profile
        C /root/.bashrc        600 root root - /usr/share/rootfiles/.bashrc
        C /root/.cshrc         600 root root - /usr/share/rootfiles/.cshrc
        C /root/.tcshrc        600 root root - /usr/share/rootfiles/.tcshrc
    </pre>

rationale: |-
    Local initialization files are used to configure the user's shell environment
    upon logon. Malicious modification of these files could compromise accounts upon
    logon.

severity: medium

platform: package[rootfiles]
